<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
		*{margin: 0;padding: 0;}
		ul,li{list-style: none;}
		input{width: 30px;height: 30px;}
		.carts{
			margin-top: 20px;
		}
		.carts ul{}
		.carts li{
			display: flex;
			height: 100px;
			align-items: center;
			width: 1000px;
			justify-content: space-around;
		}
		.carts li img{
			width: 80px;
			height: 80px;
		}
		.carts .ctrls{}
		.carts .ctrls button{
			width: 50px;
			height: 50px;
		}
		.carts .ctrls span{
			padding: 10px 20px;
			border:1px solid gray;
		}
		.all-cost{
			font-size: 25px;
			line-height: 100px;
			width: 1000px;
			text-align: right;
		}
	</style>
</head>
<body>
	<script type="text/javascript" src="./vue.js"></script>
	<div id="app">
		<carts :carts="carts"></carts>
	</div>
	<template id="carts">
		<div>
			<input type="checkbox" v-model="checkAll">
			<div class="carts">
				<ul>
					<li v-for="(good,index) in carts">
						<input type="checkbox" v-model="good.checked">	
						<img :src="good.icon" alt="">
						<p>{{good.title}}</p>
						<p>{{good.price | money}}</p>
						<div class="ctrls">
							<button @click="decrease(index)" :disabled="checks[index]">减少</button>
							<span>{{good.count}}</span>
							<button @click="increase(index)">+</button>
						</div>
					</li>
				</ul>
				<p class="all-cost">总价：{{sum}}</p>
			</div>
		</div>
	</template>
	<script type="text/javascript">
		new Vue({
			el:"#app",
			data:{
				carts:[
					{
						icon:"./images/01_mid.jpg",
						title:"iphone11",
						price:2999,
						count:1,
						checked:false
					},{
						icon:"./images/02_mid.jpg",
						title:"iphone11",
						price:1999,
						count:1,
						checked:false
					},{
						icon:"./images/03_mid.jpg",
						title:"iphone11",
						price:1999,
						count:1,
						checked:false
					},{
						icon:"./images/04_mid.jpg",
						title:"iphone11",
						price:3999,
						count:1,
						checked:false
					}
				]
			},
			components:{
				carts:{
					template:"#carts",
					methods:{
						decrease(index){
							if(this.carts[index].count<=1){
								return;
							}
							this.carts[index].count--;
						},
						increase(index){
							this.carts[index].count ++;
						},
					},
					computed:{
						sum(){
							let s = 0;
							for(let i=0;i<this.carts.length;i++){
								let good = this.carts[i];
								if(good.checked){
									s += good.price * good.count;
								}
							}
							return s;
						},
						checks(){
							let checkStates = [];
							for(let i=0;i<this.carts.length;i++){
								let good = this.carts[i];
								if(good.count<=1){
									checkStates.push(true);
								}else{
									checkStates.push(false);
								}
							}
							return checkStates;
						},
						checkAll:{
							get(){
								let isCheckedAll = true;
								for(let i=0;i<this.carts.length;i++){
									let good = this.carts[i];
									if(!good.checked){isCheckedAll = false}
								}
								return isCheckedAll;
							},
							set(val){
								for(let i=0;i<this.carts.length;i++){
									let good = this.carts[i];
									good.checked = val
								}
							}
						}
					},
					filters:{
						money(val){
							return "¥" + val;
						}
					},
					props:["carts"]
				}
			},
			
		});
	</script>
</body>
</html>